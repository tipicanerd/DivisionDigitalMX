title = "Usos de la computadora",
subtitle = "Nacional",
caption = nota,
y="Usos", x="% Residentes"
)+
scale_y_discrete(labels=usos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_uso_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# INTENSIDAD DE USO DE INTERNET
ggplot(endutih_usu %>% filter(P7_1==1), aes(P7_4, weight=FAC_PER))+
geom_histogram(aes(y=after_stat(density)*100),color=lmain, fill=main, bins = 12)+
labs(
title = "Distribución de la intensidad de uso de Internet",
subtitle = "Nacional",
caption = nota,
x="Horas de uso en un día", y="% Residentes"
)+
scale_y_continuous(n.breaks = 10)+
scale_x_continuous(n.breaks = 13)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_hist_intensidad_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#EQUIPO INTERNET
pregs <- paste("P7_5",1:7, sep="_")
#estrato1_usu[,pregs] <- as.character(estrato1_usu[,pregs])
equipo_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Equipo",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
equipos <- c(
"Ordenador", "Laptop", "Tablet",
"Smartphone", "Televisión", "Consola",
"Otro"
)
ggplot(equipo_internet, aes(y=Equipo, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Equipos donde utiliza Internet",
subtitle = "Nacional",
caption = nota,
y="Equipos", x="% Residentes"
)+
scale_y_discrete(labels=equipos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_equipo_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#LUGARES INTERNET
pregs <- paste("P7_7",1:8, sep="_")
lugar_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Lugar",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
lugares <- c(
"Hogar", "Trabajo", "Escuela",
"Sitio público\ncon costo", "Sitio público\nsin costo",
"Casa de otra\npersona", "Cualquier lugar mediante\nsmartphone",
"Otro"
)
ggplot(lugar_internet, aes(y=Lugar, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Lugares donde utiliza Internet",
subtitle = "Nacional",
caption = nota,
y="Lugares", x="% Residentes"
)+
scale_y_discrete(labels=lugares)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_lugar_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# PROBLEMAS INTERNET
pregs <- paste("P7_16",1:8, sep="_")
problema_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Problema",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
problemas <- c(
"Infección por virus", "Exceso de información\nno deseada",
"Interrupciones en el servicio", "Lentitud en la transferencia\nde información",
"Fraudes con información", "Violación a la privacidad",
"Mensajes de personas desconocidas", "Otro"
)
ggplot(problema_internet, aes(y=Problema, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Problemas de navegación en Internet",
subtitle = "Nacional",
caption = nota,
y="Lugares", x="% Residentes"
)+
scale_y_discrete(labels=problemas)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_problema_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# TIPO DE CONTRATACION CELULAR
pregs <- paste("P8_7", 1:3, sep="_")
plan_cel <- endutih_usu2 %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Plan",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
planes <- c(
"Recarga tiempo aire", "Paquetes", "Plan tarifario"
)
ggplot(plan_cel, aes(y=Plan, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Planes de contratación de servicio de celular",
subtitle = "Nacional",
caption = nota,
y="Planes", x="% Residentes"
)+
scale_y_discrete(labels=planes)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_plan_cel.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# USO DE APPS DE CELULAR
pregs <- paste("P8_12", 1:9, sep="_")
uso_cel <- endutih_usu2 %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Uso",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
usos <- c(
"Mensajería instantánea", "Contenidos de audio y video", "Adquirir bienes o servicios",
"Tránsito y navegación asistida", "Jugar", "Redes sociales", "Banca móvil",
"Editar fotos o videos", "Otros"
)
ggplot(uso_cel, aes(y=Uso, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Uso de aplicaciones móviles",
subtitle = "Nacional",
caption = nota,
y="Planes", x="% Residentes"
)+
scale_y_discrete(labels=usos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_uso_cel.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#IDTMex ESTADO DOMINIO
IDTMex_dominio_grupo_edo <- read.csv("../ConjuntosDatos/long_IDTMex_desglosado_dominio_grupos_edo.csv", stringsAsFactors = TRUE)
View(IDTMex_dominio_grupo_edo)
#### TODOS LOS ESTRATOS ####
path = "./Graficas/GRUPOS/"
IDTMex_dominio_grupo_edo["DOMGRUPO"] <- paste(str_replace(
str_replace(IDTMex_dominio_grupo_edo$DOMINIO,"R","Rural"),
"U","Urbano"
), IDTMex_dominio_grupo_edo$Grupo, sep = "-"
)
View(IDTMex_dominio_grupo_edo)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=IDTMex))+
geom_tile()+
geom_text(aes(label = round(IDTMex, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del IDTMex en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="IDTMex"
)+
#scale_y_discrete(labels=c("Ninguno", "Preescolar", "Primaria", "Secundaria","Normal básica", "Estudio técnico", "Preparatoria", "Estudio técnico superior", "Licenciatura o ingeniería", "Especialidad", "Maestría", "Doctorado", "No sabe"))+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "IDTMex_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=acceso))+
geom_tile()+
geom_text(aes(label = round(IDTMex, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del IDTMex en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="IDTMex"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=acceso))+
geom_tile()+
geom_text(aes(label = round(acceso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Acceso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "acceso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=uso))+
geom_tile()+
geom_text(aes(label = round(uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=aptitudes))+
geom_tile()+
geom_text(aes(label = round(aptitudes, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Aptitudes"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "aptitudes_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
#install.packages("pacman")
library(pacman)
p_load(
dplyr,
ggExtra,
ggplot2,
hrbrthemes,
tidyr,
tidyverse,
treemap,
paletteer,
plyr,
reshape2
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*acceso))+
geom_tile()+
geom_text(aes(label = round(10*acceso, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Acceso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "acceso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*aptitudes))+
geom_tile()+
geom_text(aes(label = round(10*aptitudes, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Aptitudes"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "aptitudes_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#install.packages("pacman")
library(pacman)
p_load(
dplyr,
ggExtra,
ggplot2,
hrbrthemes,
tidyr,
tidyverse,
treemap,
paletteer,
plyr,
reshape2
)
#### LECTURA DE DATOS #####
base_path <- "../ConjuntosDatos/"
endutih_path <- paste(base_path,"ENDUTIH2020/conjuntos_de_datos/", sep="")
#HOGARES Y VIVIENDA
endutih_vivhogar <- read.csv(
paste(endutih_path,"viv_hog_agrupados.csv", sep=""),
stringsAsFactors = TRUE
)
#RESIDENTES
endutih_res <- read.csv(
paste(endutih_path,"residente_agrupados.csv", sep=""),
stringsAsFactors = TRUE
)
#USUARIOS
endutih_usu <- read.csv(
paste(endutih_path,"usuario_agrupados.csv", sep=""),
stringsAsFactors = TRUE
)
endutih_usu2 <- read.csv(
paste(endutih_path,"usuario2_agrupados.csv", sep=""),
stringsAsFactors = TRUE
)
#ESTADOS
estados <- read.csv("../ConjuntosDatos/CodigoEdos.csv", stringsAsFactors = TRUE)
#COMPLETA
endutih_completa <- merge(endutih_vivhogar, select(endutih_res, select= -contains(c("UPM_DIS","ESTRATO","ENT","DOMINIO", "EST_DIS", "TLOC"))), by = c("UPM","VIV_SEL", "HOGAR") )
#IDTMex ESTADO
IDTMex_grupo_edo <- read.csv("../ConjuntosDatos/IDTMex_grupos_edo.csv", stringsAsFactors = TRUE)
#IDTMex ESTADO DOMINIO
IDTMex_dominio_grupo_edo <- read.csv("../ConjuntosDatos/long_IDTMex_desglosado_dominio_grupos_edo.csv", stringsAsFactors = TRUE)
#Variables universales
nota <- "Nota: Elaboración propia con datos de la ENDUTIH (2020)"
#colores
main <- "dodgerblue2"
lmain <- "dodgerblue4"
lcolor <- "royalblue4"
fcolor <- "royalblue"
nocolor <- "indianred3"
sicolor <- "steelblue2"
palette<-"ggthemes::excel_Gallery"
cpalette <- "ggthemes::Classic Blue"
path <- "./Graficas/NACIONAL/"
#### TODOS LOS ESTRATOS ####
path = "./Graficas/GRUPOS/"
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
IDTMex_dominio_grupo_edo["DOMGRUPO"] <- paste(str_replace(
str_replace(IDTMex_dominio_grupo_edo$DOMINIO,"R","Rural"),
"U","Urbano"
), IDTMex_dominio_grupo_edo$Grupo, sep = "-"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*acceso))+
geom_tile()+
geom_text(aes(label = round(10*acceso, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Acceso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "acceso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*aptitudes))+
geom_tile()+
geom_text(aes(label = round(10*aptitudes, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Aptitudes"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "aptitudes_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# DISTRIBUCION EN LOS ESTADOS
## Relativo a grupos
grupos_estado_rel_grupo <- dcast(endutih_vivhogar, Grupo~ENT, fun.aggregate = sum, value.var = "FAC_HOG")
grupos_estado_rel_grupo[,2:33] <- grupos_estado_rel_grupo[,2:33] / rowSums(grupos_estado_rel_grupo[,2:33])
grupos_estado_rel_grupo <- grupos_estado_rel_grupo %>%
pivot_longer(-Grupo, names_to = "ENT", values_to = "FAC_HOG") %>%
filter(FAC_HOG>0)
ggplot(grupos_estado_rel_grupo, aes(as.character(ENT),as.character(Grupo), fill=FAC_HOG*100))+
geom_tile()+
geom_text(aes(label = paste0(round(FAC_HOG*100, 0),"%")), color="black", size=2.3) +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,100), oob = scales::squish)+
coord_equal()+
labs(
title = "Distribución de grupos en las entidades",
subtitle = "Relativo a los grupos",
caption = nota,
y = "Grupo", x = "Entidad", fill="%"
)+
scale_x_discrete(labels=estados$ENT)+
theme_light()+
theme(
axis.text.x = element_text(angle=90),
)
