filter(respuesta==1)
modalidades <- c(
"TV de paga, telefonía fija,\nInternet y telefonía móvil",
"TV de paga, telefonía fija\ne Internet",
"TV de paga y telefonía fija",
"TV de paga e Internet",
"Telefonía fija e Internet",
"Solo TV de paga",
"Solo telefonía fija",
"Solo Internet"
)
ggplot(modalidad_servicio, aes(y=Modalidad, x=FAC_HOG))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Modalidad de contratación de servicios",
subtitle = "Nacional",
caption = nota,
y="Modalidad", x="% Hogares"
)+
scale_y_discrete(labels=modalidades)+
scale_x_continuous(n.breaks = 8)+
theme_light()+
theme()
ggsave(
path = path,
filename= "NACIONAL_modalidad_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#Aprendizaje compu
pregs <- paste("P6_6",1:7, sep="_")
aprendizaje_compu <- endutih_usu %>%
filter(P6_1==1) %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
)%>%
pivot_longer(-FAC_PER, names_to = "Metodo",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
modos <- c("Cuenta propia", "Trabajo", "Escuela", "Cursos pagados", "Cursos gratuitos", "Parientes", "Otro")
ggplot(aprendizaje_compu, aes(y=Metodo, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Modo de aprendizaje para el uso de computadora",
subtitle = "Nacional",
caption = nota,
y="Modo", x="% Residentes"
)+
scale_y_discrete(labels=modos)+
scale_x_continuous(n.breaks = 8)+
theme_light()+
theme()
ggsave(
path = path,
filename= "NACIONAL_modo_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#Lugares
pregs <- paste("P6_7",1:8, sep="_")
lugares_compu <- endutih_usu %>%
filter(P6_1==1) %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
)%>%
pivot_longer(-FAC_PER, names_to = "Lugar",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
lugares <- c(
"Hogar", "Trabajo", "Escuela",
"Sitio público\ncon costo", "Sitio público\nsin costo",
"Casa de otra persona", "Cualquier otro lugar\ncon una laptop",
"Otro"
)
ggplot(lugares_compu, aes(y=Lugar, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Lugares de uso de computadora",
subtitle = "NACIONAL",
caption = nota,
y="Lugar", x="% Residentes"
)+
scale_y_discrete(labels=lugares)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path = path,
filename= "NACIONAL_lugar_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#Habilidades
pregs <- paste("P6_8",1:10, sep="_")
habilidades_compu <- endutih_usu %>%
filter(P6_1==1) %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Habilidad",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
habilidades <- c(
"Enviar y recibir\ncorreo", "Descargar contenidos\nde Internet",
"Copiar archivos entre directorios", "Crear archivos de texto",
"Crear hojas de cáculo", "Crear presentaciones",
"Instalar dispositivos\nperiféricos", "Crear o usar\nbases de datos",
"Programar en lenguaje\nespecializado", "Otras"
)
ggplot(habilidades_compu, aes(y=Habilidad, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Habilidades con la computadora",
subtitle = "Nacional",
caption = nota,
y="Habilidad", x="% Residentes"
)+
scale_y_discrete(labels=habilidades)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_habilidad_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#Uso
pregs <- paste("P6_9",1:6, sep="_")
usos_compu <- endutih_usu %>%
filter(P6_1==1) %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Uso",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
usos <- c(
"Actividades laborales", "Labores escolares",
"Medio de capacitación", "Entretenimiento",
"Acceso a Internet", "Otro"
)
ggplot(usos_compu, aes(y=Uso, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Usos de la computadora",
subtitle = "Nacional",
caption = nota,
y="Usos", x="% Residentes"
)+
scale_y_discrete(labels=usos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_uso_compu.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# INTENSIDAD DE USO DE INTERNET
ggplot(endutih_usu %>% filter(P7_1==1), aes(P7_4, weight=FAC_PER))+
geom_histogram(aes(y=after_stat(density)*100),color=lmain, fill=main, bins = 12)+
labs(
title = "Distribución de la intensidad de uso de Internet",
subtitle = "Nacional",
caption = nota,
x="Horas de uso en un día", y="% Residentes"
)+
scale_y_continuous(n.breaks = 10)+
scale_x_continuous(n.breaks = 13)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_hist_intensidad_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#EQUIPO INTERNET
pregs <- paste("P7_5",1:7, sep="_")
#estrato1_usu[,pregs] <- as.character(estrato1_usu[,pregs])
equipo_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Equipo",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
equipos <- c(
"Ordenador", "Laptop", "Tablet",
"Smartphone", "Televisión", "Consola",
"Otro"
)
ggplot(equipo_internet, aes(y=Equipo, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Equipos donde utiliza Internet",
subtitle = "Nacional",
caption = nota,
y="Equipos", x="% Residentes"
)+
scale_y_discrete(labels=equipos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path,
filename= "NACIONAL_equipo_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#LUGARES INTERNET
pregs <- paste("P7_7",1:8, sep="_")
lugar_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Lugar",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
lugares <- c(
"Hogar", "Trabajo", "Escuela",
"Sitio público\ncon costo", "Sitio público\nsin costo",
"Casa de otra\npersona", "Cualquier lugar mediante\nsmartphone",
"Otro"
)
ggplot(lugar_internet, aes(y=Lugar, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Lugares donde utiliza Internet",
subtitle = "Nacional",
caption = nota,
y="Lugares", x="% Residentes"
)+
scale_y_discrete(labels=lugares)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_lugar_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# PROBLEMAS INTERNET
pregs <- paste("P7_16",1:8, sep="_")
problema_internet <- endutih_usu %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Problema",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
problemas <- c(
"Infección por virus", "Exceso de información\nno deseada",
"Interrupciones en el servicio", "Lentitud en la transferencia\nde información",
"Fraudes con información", "Violación a la privacidad",
"Mensajes de personas desconocidas", "Otro"
)
ggplot(problema_internet, aes(y=Problema, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Problemas de navegación en Internet",
subtitle = "Nacional",
caption = nota,
y="Lugares", x="% Residentes"
)+
scale_y_discrete(labels=problemas)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_problema_internet.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# TIPO DE CONTRATACION CELULAR
pregs <- paste("P8_7", 1:3, sep="_")
plan_cel <- endutih_usu2 %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Plan",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
planes <- c(
"Recarga tiempo aire", "Paquetes", "Plan tarifario"
)
ggplot(plan_cel, aes(y=Plan, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Planes de contratación de servicio de celular",
subtitle = "Nacional",
caption = nota,
y="Planes", x="% Residentes"
)+
scale_y_discrete(labels=planes)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_plan_cel.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
# USO DE APPS DE CELULAR
pregs <- paste("P8_12", 1:9, sep="_")
uso_cel <- endutih_usu2 %>%
select(all_of(c("FAC_PER",pregs))) %>%
mutate(
FAC_PER = FAC_PER/sum(FAC_PER)*100
) %>%
pivot_longer(-FAC_PER, names_to = "Uso",  values_to = "respuesta", values_drop_na = TRUE) %>%
filter(respuesta==1)
usos <- c(
"Mensajería instantánea", "Contenidos de audio y video", "Adquirir bienes o servicios",
"Tránsito y navegación asistida", "Jugar", "Redes sociales", "Banca móvil",
"Editar fotos o videos", "Otros"
)
ggplot(uso_cel, aes(y=Uso, x=FAC_PER))+
geom_bar(stat="identity",color=main, fill=main)+
labs(
title = "Uso de aplicaciones móviles",
subtitle = "Nacional",
caption = nota,
y="Planes", x="% Residentes"
)+
scale_y_discrete(labels=usos)+
scale_x_continuous(n.breaks = 10)+
theme_light()+
theme()
ggsave(
path=path, filename= "NACIONAL_uso_cel.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
#IDTMex ESTADO DOMINIO
IDTMex_dominio_grupo_edo <- read.csv("../ConjuntosDatos/long_IDTMex_desglosado_dominio_grupos_edo.csv", stringsAsFactors = TRUE)
View(IDTMex_dominio_grupo_edo)
#### TODOS LOS ESTRATOS ####
path = "./Graficas/GRUPOS/"
IDTMex_dominio_grupo_edo["DOMGRUPO"] <- paste(str_replace(
str_replace(IDTMex_dominio_grupo_edo$DOMINIO,"R","Rural"),
"U","Urbano"
), IDTMex_dominio_grupo_edo$Grupo, sep = "-"
)
View(IDTMex_dominio_grupo_edo)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=IDTMex))+
geom_tile()+
geom_text(aes(label = round(IDTMex, 1)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del IDTMex en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="IDTMex"
)+
#scale_y_discrete(labels=c("Ninguno", "Preescolar", "Primaria", "Secundaria","Normal básica", "Estudio técnico", "Preparatoria", "Estudio técnico superior", "Licenciatura o ingeniería", "Especialidad", "Maestría", "Doctorado", "No sabe"))+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "IDTMex_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=acceso))+
geom_tile()+
geom_text(aes(label = round(IDTMex, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del IDTMex en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="IDTMex"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=acceso))+
geom_tile()+
geom_text(aes(label = round(acceso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Acceso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "acceso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=uso))+
geom_tile()+
geom_text(aes(label = round(uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=aptitudes))+
geom_tile()+
geom_text(aes(label = round(aptitudes, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,1), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Aptitudes"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "aptitudes_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
#install.packages("pacman")
library(pacman)
p_load(
dplyr,
ggExtra,
ggplot2,
hrbrthemes,
tidyr,
tidyverse,
treemap,
paletteer,
plyr,
reshape2
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*acceso))+
geom_tile()+
geom_text(aes(label = round(10*acceso, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Acceso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "acceso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 2)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*uso))+
geom_tile()+
geom_text(aes(label = round(10*uso, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de uso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Uso"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "uso_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
ggplot(IDTMex_dominio_grupo_edo, aes(x=ENT, y=factor(DOMGRUPO), fill=10*aptitudes))+
geom_tile()+
geom_text(aes(label = round(10*aptitudes, 0)), color="white") +
scale_fill_paletteer_c("ggthemes::Classic Blue",limits=range(0,10), oob = scales::squish)+
labs(
title = "Valor del componente de acceso en los grupos por entidad",
caption = nota,
y = "Dominio-Grupo", x = "Entidad", fill="Aptitudes"
)+
theme_light()+
theme(axis.text.x = element_text(angle=90))
ggsave(
path=path, filename= "aptitudes_edo_dominio_grupo.pdf",
device="pdf", dpi="retina",
width=25, height=14, units="cm"
)
